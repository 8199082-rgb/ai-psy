<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>归因理论互动演示｜小明与数学天赋</title>
<style>
  :root{
    --bg:#f7f9fc;
    --card:#ffffff;
    --text:#1f2937;
    --muted:#6b7280;
    --accent:#2563eb;
    --good:#16a34a;
    --warn:#b45309;
    --bad:#dc2626;
    --shadow:0 10px 25px rgba(0,0,0,.07);
    --radius:18px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,"PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif;
    color:var(--text);
    background:linear-gradient(180deg,#f0f5ff, var(--bg));
  }
  header{
    padding:28px 16px 12px;
    text-align:center;
  }
  header h1{margin:0 0 6px;font-size:22px;}
  header p{margin:0;color:var(--muted);font-size:14px}
  .container{max-width:1100px;margin:0 auto;padding:16px;display:grid;gap:18px;grid-template-columns:1.1fr .9fr}
  @media (max-width:980px){.container{grid-template-columns:1fr}}

  .card{
    background:var(--card);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    padding:18px;
  }
  .scene{
    display:grid;grid-template-columns:320px 1fr;gap:16px;align-items:stretch;
  }
  @media (max-width:820px){.scene{grid-template-columns:1fr}}

  .avatarWrap{
    position:relative;
    background:linear-gradient(180deg,#fff, #f5f7ff);
    border-radius:var(--radius);
    min-height:260px;
    display:flex;align-items:center;justify-content:center;
    overflow:hidden;border:1px solid #eef2ff;
  }
  .avatar{
    width:160px;height:160px;border-radius:50%;
    background:#e0e7ff;display:flex;align-items:center;justify-content:center;
    font-size:78px;transition:.25s transform ease,.25s filter ease,.25s opacity ease;
    box-shadow:inset 0 0 0 8px #c7d2fe;
  }
  .avatar.sad{transform:translateY(6px) rotate(6deg);filter:grayscale(.6);opacity:.9}
  .avatar.hope{transform:translateY(-2px) scale(1.02)}
  .avatar.neutral{transform:none;filter:none;opacity:1}

  .bubble{
    position:absolute;top:14px;left:14px;max-width:82%;
    background:#ffffff;border:1px solid #e5e7eb;border-radius:18px;
    padding:10px 12px;font-size:14px;line-height:1.4;box-shadow:var(--shadow)
  }
  .bubble::after{
    content:"";position:absolute;left:22px;top:100%;
    border:10px solid transparent;border-top-color:#e5e7eb;transform:translateY(-1px)
  }
  .bubble::before{
    content:"";position:absolute;left:22px;top:100%;
    border:9px solid transparent;border-top-color:#ffffff;transform:translateY(-2px)
  }

  .panel h3{margin:0 0 8px}
  .meta{color:var(--muted);font-size:13px;margin:6px 0 0}

  /* Controls */
  .controls .row{margin-bottom:12px}
  .label{display:flex;justify-content:space-between;font-size:13px;color:var(--muted);margin:2px 2px 6px}
  .toggle{
    display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center
  }
  input[type="range"]{
    -webkit-appearance:none;appearance:none;width:100%;height:28px;background:transparent;outline:none;cursor:pointer;
  }
  input[type="range"]::-webkit-slider-runnable-track{
    height:12px;background:linear-gradient(90deg,#dbeafe,#bfdbfe);border-radius:999px;border:1px solid #c7d2fe;
  }
  input[type="range"]::-moz-range-track{
    height:12px;background:linear-gradient(90deg,#dbeafe,#bfdbfe);border-radius:999px;border:1px solid #c7d2fe;
  }
  input[type="range"]::-webkit-slider-thumb{
    -webkit-appearance:none;appearance:none;margin-top:-8px;width:28px;height:28px;border-radius:50%;
    background:var(--card);border:2px solid var(--accent);box-shadow:0 4px 10px rgba(37,99,235,.25)
  }
  input[type="range"]::-moz-range-thumb{
    width:28px;height:28px;border-radius:50%;background:var(--card);border:2px solid var(--accent)
  }
  .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
  .chip{
    background:#eef2ff;color:#1e3a8a;border:1px solid #c7d2fe;border-radius:999px;padding:4px 10px;font-size:12px
  }

  /* Buttons */
  .btn{border:none;border-radius:12px;padding:10px 14px;background:var(--accent);color:#fff;cursor:pointer}
  .btn:active{transform:translateY(1px)}
  .btn.secondary{background:#e5e7eb;color:#111827}

  /* Rubric / scoring */
  .rubric p{margin:.2rem 0}
  .scoreBox{
    border-radius:12px;border:1px dashed #cbd5e1;background:#f8fafc;padding:12px;margin-top:10px;font-size:14px
  }
  .score{font-weight:700}
  .score.good{color:var(--good)} .score.mid{color:var(--warn)} .score.bad{color:var(--bad)}

  textarea{
    width:100%;min-height:120px;padding:12px;border-radius:12px;border:1px solid #e5e7eb;outline:none;
    font-size:14px;resize:vertical;background:#fff
  }
  .footer{
    text-align:center;color:var(--muted);font-size:12px;padding:10px 0 26px
  }
</style>
</head>
<body>
  <header>
    <h1>互动反馈 · 难点攻克：归因理论可视化</h1>
    <p>任务：案例“小明认为自己没数学天赋”。拖动滑块→观察情绪与理论解释的变化→完成简答并自动评分。</p>
  </header>

  <main class="container">
    <!-- 左：互动区 -->
    <section class="card">
      <div class="controls">
        <div class="row">
          <div class="label"><span>归因维度</span><span>（内部 / 外部）</span></div>
          <div class="toggle" aria-label="归因维度（内部/外部）">
            <span>内部</span>
            <input id="locus" type="range" min="0" max="1" value="0" step="1" />
            <span>外部</span>
          </div>
        </div>
        <div class="row">
          <div class="label"><span>稳定性</span><span>（稳定 / 不稳定）</span></div>
          <div class="toggle" aria-label="稳定性（稳定/不稳定）">
            <span>稳定</span>
            <input id="stability" type="range" min="0" max="1" value="0" step="1" />
            <span>不稳定</span>
          </div>
        </div>
        <div class="row">
          <div class="label"><span>可控性</span><span>（可控 / 不可控）</span></div>
          <div class="toggle" aria-label="可控性（可控/不可控）">
            <span>可控</span>
            <input id="control" type="range" min="0" max="1" value="1" step="1" />
            <span>不可控</span>
          </div>
        </div>
        <div class="chips" id="chips"></div>
        <div style="display:flex;gap:10px;margin-top:10px">
          <button class="btn" id="presetAbility">一键示例：能力归因（内部·稳定·不可控）</button>
          <button class="btn secondary" id="reset">重置</button>
        </div>
      </div>

      <div class="scene" style="margin-top:16px">
        <div class="avatarWrap">
          <div class="bubble" id="bubble">我太笨了，再怎么学也没用。</div>
          <div class="avatar sad" id="avatar" aria-label="小明表情">🙁</div>
        </div>
        <div class="panel">
          <h3>理论解释</h3>
          <p id="theory">
            该设置为<strong>内部·稳定·不可控</strong>，倾向于将失败归因为「能力不足」。
            这种归因会降低努力预期并容易引发<strong>习得性无助</strong>与放弃行为。
          </p>
          <p class="meta">
            当前归因标签：<span id="tagL"></span> ｜ <span id="tagS"></span> ｜ <span id="tagC"></span>
          </p>
          <p class="meta">可能对应的原因：<span id="cause">能力（Ability）</span></p>
        </div>
      </div>
    </section>

    <!-- 右：教学评估 -->
    <aside class="card">
      <h3 style="margin-top:0">教学评估（简答自动评分）</h3>
      <p class="meta">要求：结合当前滑块设置，写出归因判断与对动机的影响（100字左右）。</p>
      <textarea id="answer" placeholder="示例：这是外部且不稳定的归因，更像侥幸心理（运气），成功归因为运气可能不会提升自我效能；失败若归因为能力不足，可能降低动机甚至产生无助感。"></textarea>
      <div style="display:flex;gap:10px;margin-top:10px">
        <button class="btn" id="scoreBtn">自动评分</button>
        <button class="btn secondary" id="clearAns">清空</button>
      </div>
      <div class="scoreBox" id="scoreBox" aria-live="polite">
        <div><strong>关键检索词</strong>（命中即加分）：</div>
        <div class="chips" style="margin-top:6px">
          <span class="chip">外部 / 外在</span>
          <span class="chip">不稳定</span>
          <span class="chip">侥幸心理 / 运气</span>
          <span class="chip">降低动机 / 无助</span>
        </div>
        <div id="scoreText" style="margin-top:8px">
          当前得分：<span class="score bad" id="score">0 / 3</span>
          <div id="scoreDetail" class="meta" style="margin-top:6px">请作答后点击“自动评分”。</div>
        </div>
      </div>

      <div class="rubric" style="margin-top:12px">
        <p><strong>评分规则（初步）：</strong></p>
        <p>· 提及“外部/外在”且“ 不稳定 ” → +1</p>
        <p>· 提及“侥幸心理 / 运气” → +1</p>
        <p>· 提及“降低动机 / 无助（习得性无助等）” → +1</p>
      </div>
    </aside>
  </main>

  <div class="footer">© 归因理论交互小练习 · 仅用于教学示范</div>

<script>
(function(){
  const $ = (id)=>document.getElementById(id);

  const sliders = { locus:$("locus"), stability:$("stability"), control:$("control") };
  const tagL=$("tagL"), tagS=$("tagS"), tagC=$("tagC");
  const chips=$("chips"), bubble=$("bubble"), avatar=$("avatar"), theory=$("theory");
  const causeEl=document.querySelector(".panel .meta span#cause") || document.querySelectorAll(".panel .meta")[1]?.querySelector("span");

  const labels = {
    locus: ["内部","外部"],
    stability: ["稳定","不稳定"],
    control: ["可控","不可控"]
  };

  const presets = {
    "内部|稳定|不可控": {
      emoji:"🙁", mood:"sad",
      bubble:"我太笨了，再怎么学也没用。",
      cause:"能力（Ability）",
      theory:"该设置为<strong>内部·稳定·不可控</strong>——典型的「能力」归因。稳定且不可控会降低对努力的效用预期，易引发<strong>习得性无助</strong>、降低持久动机。"
    },
    "内部|不稳定|可控": {
      emoji:"🙂", mood:"hope",
      bubble:"如果我多练习、换策略，下次会更好！",
      cause:"努力（Effort）",
      theory:"这是<strong>内部·不稳定·可控</strong>的「努力」归因。强调可改进与可控性，通常提升自我效能与后续动机。"
    },
    "外部|稳定|不可控": {
      emoji:"😕", mood:"neutral",
      bubble:"这次题目难度超纲了……",
      cause:"任务难度（Task Difficulty）",
      theory:"这是<strong>外部·稳定·不可控</strong>。短期能保护自我价值，但若长期稳定外部障碍存在，会降低期望与坚持。"
    },
    "外部|不稳定|不可控": {
      emoji:"😌", mood:"neutral",
      bubble:"今天有点背，运气不好。",
      cause:"运气（Luck）",
      theory:"这是<strong>外部·不稳定·不可控</strong>的「运气」归因。可缓冲情绪，但对能力感与长期动机提升有限。"
    },
    // 其余 4 种组合：给出合理的引导性解释
    "内部|稳定|可控": {
      emoji:"🙂", mood:"neutral",
      bubble:"我一直用同一种方法，可能该系统地调整习惯了。",
      cause:"固定习惯 / 策略选择",
      theory:"<strong>内部·稳定·可控</strong>。偏向稳定的学习习惯或策略，但可通过计划与训练改变，强调可控可避免无助。"
    },
    "内部|不稳定|不可控": {
      emoji:"😕", mood:"neutral",
      bubble:"最近身体/情绪不太在线，状态起伏大。",
      cause:"状态波动（情绪/健康）",
      theory:"<strong>内部·不稳定·不可控</strong>。短期受生理或情绪影响，提醒关注身心与节奏，避免将短期波动解释为能力不足。"
    },
    "外部|稳定|可控": {
      emoji:"🙂", mood:"hope",
      bubble:"也许我可以找辅导、换教材或争取更多练习资源！",
      cause:"资源与支持（可争取）",
      theory:"<strong>外部·稳定·可控</strong>。外部条件相对稳定，但可通过寻求支持与资源配置来改变处境。"
    },
    "外部|不稳定|可控": {
      emoji:"🙂", mood:"hope",
      bubble:"时间管理没安排好，下次按计划来就行。",
      cause:"情境与管理（可改进）",
      theory:"<strong>外部·不稳定·可控</strong>。临时性外因，可通过策略与时间管理改善，利于恢复控制感。"
    }
  };

  function readState(){
    const L = labels.locus[+sliders.locus.value];
    const S = labels.stability[+sliders.stability.value];
    const C = labels.control[+sliders.control.value];
    return {L,S,C,key:`${L}|${S}|${C}`};
  }

  function renderChips({L,S,C}){
    chips.innerHTML = `
      <span class="chip">归因维度：${L}</span>
      <span class="chip">稳定性：${S}</span>
      <span class="chip">可控性：${C}</span>`;
  }

  function setAvatar(emoji,mood){
    avatar.textContent = emoji;
    avatar.classList.remove("sad","hope","neutral");
    avatar.classList.add(mood||"neutral");
  }

  function update(){
    const st = readState();
    tagL.textContent = st.L; tagS.textContent = st.S; tagC.textContent = st.C;
    renderChips(st);

    const preset = presets[st.key] || null;
    if(preset){
      bubble.textContent = preset.bubble;
      theory.innerHTML = preset.theory;
      if(causeEl) causeEl.textContent = preset.cause;
      setAvatar(preset.emoji, preset.mood);
    }else{
      bubble.textContent = "（思考中……）";
      theory.innerHTML = `当前设置：<strong>${st.L}·${st.S}·${st.C}</strong>。请结合三维度分析其对情绪、期望与动机的影响。`;
      if(causeEl) causeEl.textContent = "—";
      setAvatar("🙂","neutral");
    }
  }

  Object.values(sliders).forEach(el=>el.addEventListener("input",update));
  document.getElementById("presetAbility").addEventListener("click", ()=>{
    sliders.locus.value=0;      // 内部
    sliders.stability.value=0;  // 稳定
    sliders.control.value=1;    // 不可控
    update();
  });
  document.getElementById("reset").addEventListener("click", ()=>{
    sliders.locus.value=0;
    sliders.stability.value=0;
    sliders.control.value=1;
    update();
  });

  // ---- 教学评估：关键词自动评分 ----
  const scoreSpan=document.getElementById("score"), scoreDetail=document.getElementById("scoreDetail");
  function scoreAnswer(){
    const txt = (document.getElementById("answer").value||"").replace(/\s+/g,"").toLowerCase();

    // 组1：外部 & 不稳定（至少命中任一关键词分别加半分，合计满1分）
    const exts = /(外部|外在|情境|环境|题目难度|老师|考试太难|资源|家庭)/;
    const unstable = /(不稳定|临时|偶发|暂时|波动)/;

    // 组2：侥幸心理 / 运气
    const luck = /(侥幸|运气|走运|luck)/;

    // 组3：降低动机 / 无助
    const demot = /(降低动机|动机下降|失去动力|不想学了|无助|习得性无助|放弃)/;

    let s=0, hits=[];
    let s1 = 0;
    if(exts.test(txt)){ s1+=0.5; hits.push("命中：外部/外在"); }
    if(unstable.test(txt)){ s1+=0.5; hits.push("命中：不稳定"); }
    s += Math.min(1, s1);

    if(luck.test(txt)){ s+=1; hits.push("命中：侥幸/运气"); }
    if(demot.test(txt)){ s+=1; hits.push("命中：降低动机/无助"); }

    s = Math.min(3, s);
    scoreSpan.textContent = `${s} / 3`;
    scoreSpan.className = "score " + (s>=2.5?"good": s>=1.5?"mid":"bad");

    const miss = [];
    if(s1<1){ if(!exts.test(txt)) miss.push("外部/外在"); if(!unstable.test(txt)) miss.push("不稳定"); }
    if(!luck.test(txt)) miss.push("侥幸/运气");
    if(!demot.test(txt)) miss.push("降低动机/无助");

    scoreDetail.innerHTML = (hits.length? ("✅ " + hits.join("，")) : "尚未命中特定关键词。")
      + (miss.length? ("<br>👉 建议补充：<em>"+miss.join("，")+"</em>。"):"")
      + "<br><span class='meta'>提示：本评分仅作快速诊断，教师应结合内容准确性与逻辑性综合评价。</span>";
  }

  document.getElementById("scoreBtn").addEventListener("click", scoreAnswer);
  document.getElementById("clearAns").addEventListener("click", ()=>{
    document.getElementById("answer").value="";
    scoreSpan.textContent="0 / 3";
    scoreSpan.className="score bad";
    scoreDetail.textContent="请作答后点击“自动评分”。";
  });

  // 初始呈现：能力归因
  update();
})();
</script>
</body>
</html>
